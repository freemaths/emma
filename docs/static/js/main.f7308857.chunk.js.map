{"version":3,"sources":["cpr.csv.gz","SOCAT.csv.gz","Emma.js","index.js"],"names":["mnth","dd_mm_yyyy","str","m","match","d","Date","getFullYear","Emma","state","data","monthTimer","set","timer","clearTimeout","setState","a","y","y2","m2","setTimeout","yearTimer","socat","ys","Object","keys","ps","length","indexOf","animate","arg","cpr","name","cols","x","date","ABUN","filter","min","max","errors","SOCAT","CO2","SSS","SST","forEach","s","load_data","then","console","log","lines","filtered","catch","e","error","this","f","Promise","resolve","reject","fetch","response","arrayBuffer","csv","rows","pako","inflate","to","split","map","l","replace","head","r","trim","n","ks","i","k","push","file","line","toString","year","month","getMonth","p","Math","round","undefined","ret","c","t","onClick","Fragment","all","Map","bounds","TileLayer","url","attribution","Component","PYM","props","dedupe","zero","pa","yr","mn","mi","v","color","center","radius","points","cs","CircleMarker","Select","preventDefault","target","value","options","ss","onChange","ReactDOM","render","document","getElementById"],"mappings":"sNAAe,MAA0B,mCCA1B,MAA0B,qC,wBCKnCA,EAAO,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAE3F,SAASC,EAAWC,GAClB,IAAMC,EAAID,EAAIE,MAAM,iDACdC,EAAIF,EAAI,IAAIG,KAAKH,EAAE,GAAIA,EAAE,GAAK,EAAGA,EAAE,GAAKA,EAAE,IAAMA,EAAE,IAAO,EAAIA,EAAE,IAAMA,EAAE,IAAO,EAAG,GAAK,KAC5F,OAAKE,GAAMA,EAAEE,cACDF,EADuB,K,IAI/BG,E,4MACJC,MAAQ,G,EACRC,KAAO,G,EA+HPC,WAAa,SAACC,GACZ,IAAMT,EAAI,EAAKM,MAAMN,EACjB,EAAKU,OAAOC,aAAa,EAAKD,OAC9BD,EAAK,EAAKG,SAAS,CAAEC,EAAGJ,EAAKT,EAAG,EAAGc,EAAG,MAAOC,GAAI,KAAMC,GAAI,OAChD,KAANhB,EAAU,EAAKY,SAAS,CAAEZ,EAAG,IACjC,EAAKY,SAAS,CAAEZ,EAAGA,EAAI,IAC5B,EAAKU,MAAQO,WAAW,EAAKT,WAAkB,KAANR,EAAW,IAAO,M,EAE7DkB,UAAY,SAACT,GACX,IAAMK,EAAI,EAAKR,MAAMQ,EACfK,EAAQ,EAAKb,MAAMa,MAAOC,EAAKC,OAAOC,KAAKH,EAAMI,IACnD,EAAKb,OAAOC,aAAa,EAAKD,OAC9BD,EAAK,EAAKG,SAAS,CAAEC,EAAGJ,EAAKK,EAAGM,EAAG,GAAIpB,EAAG,MAAOe,GAAI,KAAMC,GAAI,OAC1DF,IAAMM,EAAGA,EAAGI,OAAS,GAAI,EAAKZ,SAAS,CAAEE,EAAGM,EAAG,KACnD,EAAKR,SAAS,CAAEE,EAAGM,EAAGA,EAAGK,QAAQX,GAAK,KAC3C,EAAKJ,MAAQO,WAAW,EAAKC,UAAWJ,IAAMM,EAAGA,EAAGI,OAAS,GAAK,IAAO,M,EAE3EE,QAAU,SAACC,GACT,IAAMd,EAAI,CAAC,UAAW,WAAY,WAAWY,QAAQE,GACjD,EAAKjB,OAAOC,aAAa,EAAKD,OAClC,EAAKA,MAAQ,KACH,IAANG,IAAkB,IAAPA,EAAU,EAAKD,SAAS,CAAEC,EAAG,KAAMC,EAAG,KAAMd,EAAG,OAC/C,IAANa,EAAS,EAAKL,WAAWmB,GACnB,IAANd,GAAS,EAAKK,UAAUS,I,uDArJnC,WAAqB,IAAD,OAClB,CAEE,CAAEpB,KAAMqB,EAAKC,KAAM,MAAOC,KAAM,CAAEC,EAAG,WAAYjB,EAAG,YAAakB,KAAM,sBAAuBC,KAAM,OAASD,KAAMlC,EAAYoC,OAAQ,CAAEF,KAAM,CAAEG,IAAK,KAAMC,IAAK,OAAUC,OAAQ,IAEnL,CAAE9B,KAAM+B,EAAOT,KAAM,QAASC,KAAM,CAAEC,EAAG,MAAOjB,EAAG,MAAOkB,KAAM,OAAQO,IAAK,oBAAqBC,IAAK,wBAAyBC,IAAK,oBAAsBP,OAAQ,CAAEM,IAAK,CAAEL,IAAK,GAAIC,IAAK,IAAMG,IAAK,CAAEJ,IAAK,IAAKC,IAAK,KAAOJ,KAAM,CAAEG,IAAK,KAAMC,IAAK,MAAQL,EAAG,CAAEI,IAAK,GAAIC,IAAK,IAAMtB,EAAG,CAAEqB,KAAM,GAAIC,IAAK,KAAQJ,KAAMlC,EAAYuC,OAAQ,MAC5UK,SAAQ,SAAAC,GAAC,OAAI,EAAKC,UAAUD,GAC3BE,MAAK,SAAA3C,GACJ,EAAKK,KAAKL,EAAE2B,MAAQ3B,EAChBA,EAAEmC,OAAOb,QAAQsB,QAAQC,IAAI7C,EAAE2B,KAAM,SAAU3B,EAAEmC,QACrDS,QAAQC,IAAI7C,EAAE2B,KAAM,CAAEmB,MAAO9C,EAAE8C,MAAOC,SAAU/C,EAAEgC,OAAQhC,MAC3C,UAAXA,EAAE2B,KAAkB,EAAKjB,SAAS,CAAEO,MAAOjB,IAC1C,EAAKU,SAAS,CAAEgB,IAAK1B,OACzBgD,OAAM,SAAAC,GACPL,QAAQM,MAAMD,EAAEtB,KAAM,kBAAmBsB,EAAEd,gB,kCAGjD,WACEgB,KAAK3B,QAAQ,U,uBAEf,SAAU4B,GACR,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAC3BC,MAAMJ,EAAE/C,MACLsC,MAAK,SAAUc,GACd,OAAOA,EAASC,iBAEjBf,MAAK,SAAAgB,GACJ,IAAIC,EAAOC,IAAKC,QAAQH,EAAK,CAAEI,GAAI,WAAYC,MAAM,WAAWC,KAAI,SAAAC,GAAO,OAAOA,EAAEC,QAAQ,qBAAsB,SAASA,QAAQ,KAAM,IAAIH,MAAM,QAC7II,EAAOR,EAAK,GAAGK,KAAI,SAAAI,GAAO,OAAOA,EAAEC,UACnCjE,EAAO,CAAEsB,KAAMyB,EAAEzB,KAAMuC,EAAG,GAAI7C,GAAI,GAAIH,GAAI,GAAIqD,EAAG,GAAIpC,OAAQ,GAAIW,MAAO,EAAGd,OAAQ,GAH9E,aAKT,IAAMqC,EAAIT,EAAKvD,EAAKyC,OACd9C,EAAI,GAAIwE,EAAKrD,OAAOC,KAAKgC,EAAExB,MACjC,IAAS6C,EAAI,EAAGA,EAAID,EAAGlD,OAAQmD,IAAK,CAClC,IAAMC,EAAIF,EAAGC,GACRJ,EAAED,EAAK7C,QAAQ6B,EAAExB,KAAK8C,KAKP1E,EAAE0E,GAAV,SAANA,EAAqBtB,EAAEtB,KAAKuC,EAAED,EAAK7C,QAAQ6B,EAAExB,KAAK8C,MACb,EAA7BL,EAAED,EAAK7C,QAAQ6B,EAAExB,KAAK8C,MALlC1E,EAAEkD,OAAQ,EACLlD,EAAEkD,OAAO7C,EAAK8B,OAAOwC,KAAK,CAAE1B,EAAG,IAAK2B,KAAMxB,EAAEzB,KAAMkD,KAAMxE,EAAKyC,MAAO4B,EAAGA,KAMzE1E,EAAE0E,IAAe,IAAT1E,EAAE0E,IAAa1E,EAAEkD,QAC5BlD,EAAEkD,OAAQ,EACV7C,EAAK8B,OAAOwC,KAAK,CAAE1B,EAAG,IAAK2B,KAAMxB,EAAEzB,KAAMkD,KAAMxE,EAAKyC,MAAO4B,EAAGA,KAwBlE,GArBK1E,EAAEkD,QAAYlD,EAAE6B,GAAa,IAAR7B,EAAE6B,KAAc7B,EAAEY,GAAa,IAARZ,EAAEY,IAAaZ,EAAE8B,OAChE9B,EAAEkD,OAAQ,EACV7C,EAAK8B,OAAOwC,KAAK,CAAE1B,EAAG,IAAK2B,KAAMxB,EAAEzB,KAAMkD,KAAMxE,EAAKyC,MAAOjB,EAAG7B,EAAE6B,EAAGjB,EAAGZ,EAAEY,MAErEZ,EAAEkD,OAASE,EAAEpB,QAAQb,OAAOC,KAAKgC,EAAEpB,QAAQQ,SAAQ,SAAAX,GACtD,IAAIqC,EAAI,CAAEW,KAAMxE,EAAKyC,OACX,SAANjB,GACG7B,EAAEgC,SAAWhC,EAAE8B,KAAK5B,cAAgBkD,EAAEpB,OAAOF,KAAKG,KAAOjC,EAAE8B,KAAK5B,cAAgBkD,EAAEpB,OAAOF,KAAKI,OACjGlC,EAAEgC,QAAS,EACXkC,EAAErC,GAAK7B,EAAE6B,GAAGiD,WACZzE,EAAK2B,WAIFhC,EAAEgC,SAAWhC,EAAE6B,GAAKuB,EAAEpB,OAAOH,GAAGI,KAAOjC,EAAE6B,GAAKuB,EAAEpB,OAAOH,GAAGK,OAC7DlC,EAAEgC,QAAS,EACXkC,EAAErC,GAAK7B,EAAE6B,GACTxB,EAAK2B,cAINhC,EAAEkD,QAAUlD,EAAEgC,OAAQ,CACzB,IAAM+C,EAAO/E,EAAE8B,KAAK5B,cACd8E,EAAQhF,EAAE8B,KAAKmD,WACfC,EAAIC,KAAKC,MAAY,IAANpF,EAAE6B,GAAa7B,EAAEY,EACjCP,EAAKgB,GAAG0D,KAAO1E,EAAKgB,GAAG0D,GAAQ,IAC/B1E,EAAKgB,GAAG0D,GAAMC,KAAQ3E,EAAKgB,GAAG0D,GAAMC,GAAS,IAC7C3E,EAAKgB,GAAG0D,GAAMC,GAAOE,GAUrB7E,EAAK8B,OAAOwC,KAAK,CAAE1B,EAAG,OAAQ2B,KAAMxB,EAAEzB,KAAMkD,KAAMxE,EAAKyC,MAAOjB,EAAG7B,EAAE6B,EAAGjB,EAAGZ,EAAEY,KAT9EP,EAAKgB,GAAG0D,GAAMC,GAAOE,GAAKlF,EACvB,CAAC,IAAK,IAAK,MAAO,MAAO,MAAO,QAAQwC,SAAQ,SAAAkC,QAC7BW,IAAdhF,EAAK6D,EAAEQ,GAAkBrE,EAAK6D,EAAEQ,GAAK,CAAEzC,IAAKjC,EAAE0E,GAAIxC,IAAKlC,EAAE0E,KAC1C,OAAV1E,EAAE0E,KACF1E,EAAE0E,GAAKrE,EAAK6D,EAAEQ,GAAGzC,IAAK5B,EAAK6D,EAAEQ,GAAGzC,IAAMjC,EAAE0E,GACxC1E,EAAE0E,GAAKrE,EAAK6D,EAAEQ,GAAGxC,MAAK7B,EAAK6D,EAAEQ,GAAGxC,IAAMlC,EAAE0E,WAnD3D,IAAKrE,EAAKyC,MAAQ,EAAGzC,EAAKyC,MAAQc,EAAKtC,QAAUjB,EAAK8B,OAAOb,OAAS8B,EAAEjB,OAAQ9B,EAAKyC,QAAS,CAAC,IAGpF2B,EAHmF,IA0D1FpE,EAAK8B,OAAOb,OAAS8B,EAAEjB,OAazBmB,EAAQjD,GAELkD,EAAOlD,W,oBAIpB,SAAOA,GACL,IAAMiF,EAAM,GAgBZ,OAfAnE,OAAOC,KAAKf,EAAKa,IAAIsB,SAAQ,SAAA5B,GAC3BO,OAAOC,KAAKf,EAAKa,GAAGN,IAAI4B,SAAQ,SAAA+C,GAC9B,IAAIC,EAAI,EAAGjB,EAAI,EACflE,EAAKa,GAAGN,GAAG2E,GAAG/C,SAAQ,SAAA0C,GACpB7E,EAAKgB,GAAG6D,GAAGtE,GAAG4B,SAAQ,SAAAxC,GACpBuE,GAAK,EAAIlE,EAAKgB,GAAG6D,GAAGtE,GAAGU,OACvBkE,GAAKxF,EAAEuE,EAAIlE,EAAKgB,GAAG6D,GAAGtE,GAAGU,aAGxBgE,EAAI1E,KAAI0E,EAAI1E,GAAK,IACjB0E,EAAI1E,GAAG2E,KAAID,EAAI1E,GAAG2E,GAAK,IAC5BD,EAAI1E,GAAG2E,GAAK,CAAEhB,EAAGA,EAAGiB,EAAGA,SAIpBF,I,oBA2BT,WAAU,IAAD,OACDrE,EAAQkC,KAAK/C,MAAMa,MACzB,IAAKA,EAAO,OAAO,mDACnB,IAAML,EAAIuC,KAAK/C,MAAMQ,EAAGC,EAAKsC,KAAK/C,MAAMS,GAAIK,EAAKC,OAAOC,KAAKH,EAAMI,IAC7DvB,EAAIqD,KAAK/C,MAAMN,EAAGgB,EAAKqC,KAAK/C,MAAMU,GAClCyE,EAAIpC,KAAK/C,MAAMmF,EAAG9C,EAAIU,KAAK/C,MAAMqC,EAAG9B,EAAIwC,KAAK/C,MAAMO,EACnDe,EAAMyB,KAAK/C,MAAMsB,IACvB,OAAO,gCACL,gCACE,cAAC,EAAD,CAAQ8C,GAAI,CAAC,QAASE,EAAGvB,KAAK/C,MAAMmF,EAAGhF,IAAK,SAAA6C,GAAC,OAAI,EAAK1C,SAAS,CAAE6E,EAAGnC,KAAMzB,KAAK,QAC/E,cAAC,EAAD,CAAQ6C,GAAI,CAAC,MAAO,MAAO,OAAQE,EAAGvB,KAAK/C,MAAMqC,EAAGlC,IAAK,SAAA6C,GAAC,OAAI,EAAK1C,SAAS,CAAE+B,EAAGW,KAAMzB,KAAK,UAC3F4D,GAAK9C,EAAU,YAAN9B,GAAyB,aAANA,EAAmB,wBAAQ8E,QAAS,kBAAM,EAAKjE,QAAQ,SAApC,kBAC9C,eAAC,IAAMkE,SAAP,WACE,qCACA,cAAC,EAAD,CAAQlB,GAAI,CAAC,UAAW,YAAaE,EAAG/D,EAAGJ,IAAK4C,KAAK3B,QAASG,KAAK,YACnE,wCACA,cAAC,EAAD,CAAQ6C,GAAItD,EAAIyE,KAAG,EAACjB,EAAG9D,EAAGL,IAAK,SAAAK,GAAC,OAAI,EAAKF,SAAS,CAAEE,EAAGA,EAAGC,GAAI,QAAUc,KAAK,SAC5Ef,GAAW,QAANA,GAAqB,SAANA,EAAe,cAAC,EAAD,CAAQ4D,GAAItD,EAAIuB,EAAG7B,EAAG8D,EAAG7D,EAAIN,IAAK,SAAAK,GAAC,OAAI,EAAKF,SAAS,CAAEG,GAAID,KAAMe,KAAK,YAAe,KACzH,cAAC,EAAD,CAAQ6C,GAAI7E,EAAMgG,KAAG,EAACjB,EAAS,QAAN5E,EAAc,MAAQH,EAAKG,GAAIS,IAAK,SAAAT,GAAC,OAAI,EAAKY,SAAS,CAAEZ,EAAS,QAANA,EAAc,MAAQA,GAAKH,EAAK4B,QAAQzB,GAAIgB,GAAI,QAASa,KAAK,WACjJ7B,GAAW,IAANA,GAAkB,QAANA,GAAqB,KAANA,EAAkI,KAAvH,cAAC,EAAD,CAAQ0E,GAAI7E,EAAM8C,EAAG9C,EAAKG,GAAI4E,EAAG/E,EAAKmB,GAAKP,IAAK,SAAAT,GAAC,OAAI,EAAKY,SAAS,CAAEI,GAAIhB,GAAKH,EAAK4B,QAAQzB,MAAO6B,KAAK,gBAClI,KAEtB,qCAAc,QAANf,EAAc,YAAcA,EAAGC,EAAK,IAAMA,EAAK,KAAvD,IAAoE,KAANf,GAAkB,QAANA,EAAc,UAAYH,EAAKG,GAAIgB,EAAK,IAAMnB,EAAKmB,GAAM,WAEpIG,GAAS,eAAC2E,EAAA,EAAD,CAAKC,OAAQ,CAAC,CAAC5E,EAAMiD,EAAErC,EAAEI,IAAKhB,EAAMiD,EAAEtD,EAAEqB,KAAM,CAAChB,EAAMiD,EAAErC,EAAEK,IAAKjB,EAAMiD,EAAEtD,EAAEsB,MAAxE,UACR,cAAC4D,EAAA,EAAD,CACEC,IAAI,qDACJC,YAAY,2EAEbvD,EAAI,cAAC,EAAD,CAAKpC,KAAMY,EAAOnB,EAAGA,EAAGc,EAAGA,EAAGC,GAAIA,EAAIC,GAAIA,EAAIsC,EAAGX,EAAG9B,EAAGwC,KAAK/C,MAAMO,IAAQ,KAC9E4E,EAAI,cAAC,EAAD,CAAKlF,KAAMqB,EAAK5B,EAAGA,EAAGc,EAAGA,EAAGC,GAAIA,EAAIC,GAAIA,EAAIsC,EAAGmC,EAAG5E,EAAGwC,KAAK/C,MAAMO,IAAQ,e,GAxLlEsF,aA+LbC,E,4JACJ,WACE,IAAMtF,EAAIuC,KAAKgD,MAAMvF,EAAGd,EAAIqD,KAAKgD,MAAMrG,EAAGe,EAAKsC,KAAKgD,MAAMtF,GAAIC,EAAKqC,KAAKgD,MAAMrF,GAAIsC,EAAID,KAAKgD,MAAM/C,EAAGpD,EAAImD,KAAKgD,MAAM9F,KACjHa,EAAKC,OAAOC,KAAKpB,EAAEqB,IAAKV,EAAIwC,KAAKgD,MAAMxF,EAErC2E,EAAM,GAAIf,EAAI,EAAG6B,EAAS,EAAGC,EAAO,EAAGC,EAAK,GAgBhD,GAfApF,EAAGsB,SAAQ,SAAA+D,IACC,QAAN3F,GAAe2F,IAAO3F,GAAMC,GAAM0F,GAAM1F,GAAM0F,EAAK3F,IACrDjB,EAAK6C,SAAQ,SAAAgE,GACX,IAAMC,EAAK9G,EAAK4B,QAAQiF,GACxB,GAAU,QAAN1G,GAAqB,KAANA,GAAY2G,IAAO3G,GAAMgB,GAAM2F,EAAK3G,GAAK2G,GAAM3F,EAAK,CACrE,IAAMO,EA4BlB,SAAgB6D,GACd,IAAII,EAAM,GACJ1E,EAAIsE,EAAEtE,EAAGd,EAAIoF,EAAEpF,EAAGsD,EAAI8B,EAAE9B,EAAGpD,EAAIkF,EAAElF,EACrCqB,EAAKT,IAAMd,GAAW,IAANA,IAAYE,EAAEqB,GAAGT,IAAMZ,EAAEqB,GAAGT,GAAGd,IAAMqB,OAAOC,KAAKpB,EAAEqB,GAAGT,GAAGd,IAEvEuB,GAAIA,EAAGmB,SAAQ,SAAA0C,GACjB,IAAMwB,EAAI1G,EAAEqB,GAAGT,GAAGd,GAAGoF,GACfhB,EAAIlE,EAAEkE,EAAGqB,GAAKmB,EAAEtD,GAAKc,EAAEd,GAAGnB,MAAQiC,EAAEd,GAAGlB,IAAMgC,EAAEd,GAAGnB,KAClD0E,EAAQD,EAAEtD,KAAa,SAANA,EAAesD,EAAEtD,IAAM,OAAS,IAAM+B,KAAKC,MAAU,IAAJG,IAAUT,SAAS,IAAM,KAC7F,KAAO,IAAMK,KAAKC,MAAU,IAAJG,IAAUT,SAAS,IAAM,SAEvC,OAAV4B,EAAEtD,IACJkC,EAAIX,KAAK,CAAEiC,OAAQ,CAACF,EAAE7E,EAAG6E,EAAE9F,GAAIiG,OAAQ,EAAGF,MAAOA,OAGrD,OAAOrB,EA3CcwB,CAAO,CAAElG,EAAG2F,EAAIzG,EAAG2G,EAAIrD,IAAGpD,MACjCqB,EAAGC,SACLgF,EAAG3B,KAAKtD,GACRkD,GAAKlD,EAAGC,QAELX,GAAGiC,QAAQC,IAAI0D,EAAIC,EAAInF,EAAGC,eAKnCgF,EAAGhF,OAAQ,CACb,IAAImD,EAAI,EAAGsC,EAAK,GAChBT,EAAG9D,SAAQ,SAAAnB,GACTA,EAAGmB,SAAQ,SAAA0C,GACJ6B,EAAiB,IAAd7B,EAAE0B,OAAO,GAAY1B,EAAE0B,OAAO,IAIjCR,MAHC7B,EAAI,KAAQW,EAAEyB,QAAOrB,EAAIX,KAAK,cAACqC,EAAA,EAAD,CAAwBJ,OAAQ1B,EAAE0B,OAAQC,OAAQ3B,EAAE2B,OAAQF,MAAOzB,EAAEyB,OAAlDlC,MACrDsC,EAAiB,IAAd7B,EAAE0B,OAAO,GAAY1B,EAAE0B,OAAO,KAAM,GAGpC1B,EAAEyB,OAAON,UAKpB,OADAzD,QAAQC,IAAI,MAAO,CAAEjC,IAAGd,IAAGsD,IAAGmB,IAAG8B,OAAMD,WAChCd,EAAIhE,OAASgE,EAAM,S,GAnCZW,a,IA2FZgB,E,4MACJ1G,IAAM,SAAC0C,GACLA,EAAEiE,iBACF,EAAKf,MAAM5F,IAAI0C,EAAEkE,OAAOC,Q,4CAE1B,WACE,IAAIC,EAAU,CAAC,wBAAiBD,MAAM,GAAvB,SAA2BjE,KAAKgD,MAAMxE,MAAzB,KACtBc,EAAIU,KAAKgD,MAAM1D,EACjB6E,GAAK,EAMT,OALInE,KAAKgD,MAAMR,KAAK0B,EAAQ1C,KAAK,wBAAoByC,MAAM,MAA1B,gBAAa,QAC9CjE,KAAKgD,MAAM3B,GAAGhC,SAAQ,SAAAS,IACfR,GAAK6E,EAAID,EAAQ1C,KAAK,iCAAiB1B,GAAJA,IAC/BR,IAAMQ,IAAGqE,GAAK,MAElB,+BACL,wBAAQF,MAAOjE,KAAKgD,MAAMzB,GAAK,GAAI6C,SAAUpE,KAAK5C,IAAlD,SAAwD8G,U,GAfzCpB,a,MCnSrBuB,IAASC,OACP,cAAC,EAAD,IACAC,SAASC,eAAe,W","file":"static/js/main.f7308857.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/cpr.csv.24831468.gz\";","export default __webpack_public_path__ + \"static/media/SOCAT.csv.c5d052c4.gz\";","import React, { Component } from 'react'\r\nimport { Map, TileLayer, CircleMarker } from 'react-leaflet'\r\nimport cpr from './cpr.csv.gz'\r\nimport SOCAT from './SOCAT.csv.gz'\r\nimport pako from 'pako'\r\nconst mnth = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\r\n\r\nfunction dd_mm_yyyy(str) {\r\n  const m = str.match(/^(\\d\\d)\\/(\\d\\d)\\/(\\d\\d\\d\\d)( (\\d\\d):(\\d\\d))?$/)\r\n  const d = m ? new Date(m[3], m[2] - 1, m[1], (m[4] && m[5]) || 0, (m[4] && m[6]) || 0, 0) : null\r\n  if (!d || !d.getFullYear()) return null\r\n  else return d\r\n}\r\n\r\nclass Emma extends Component {\r\n  state = {}\r\n  data = {}\r\n  componentDidMount() {\r\n    [\r\n      //[\"Sample_Id\", \"Latitude\", \"Longitude\", \"Midpoint_Date_Local\", \"Year\", \"Month\", \"195\", \"10508\", \"10509\", \"10510\", \"10511\", \"10512\", \"10513\", \"10514\", \"10515\"]\r\n      { data: cpr, name: 'cpr', cols: { x: 'Latitude', y: 'Longitude', date: 'Midpoint_Date_Local', ABUN: '195' }, date: dd_mm_yyyy, filter: { date: { min: 1993, max: 2018 } }, errors: 20 },\r\n      //[\"DATE\", \"LAT\", \"LON\", \" COUNT_NCRUISE\", \" FCO2_COUNT_NOBS\", \" FCO2_AVE_WEIGHTED\", \" FCO2_AVE_UNWTD\", \" FCO2_MIN_UNWTD\", \" FCO2_MAX_UNWTD\", \" SST_COUNT_NOBS\", \" SST_AVE_WEIGHTED\", \" SST_AVE_UNWTD\", \" SST_MIN_UNWTD\", \" SST_MAX_UNWTD\", \" SALINITY_COUNT_NOBS\", \" SALINITY_AVE_WEIGHTED\", \" SALINITY_AVE_UNWTD\", \" SALINITY_MIN_UNWTD\", \" SALINITY_MAX_UNWTD\"\r\n      { data: SOCAT, name: 'SOCAT', cols: { x: 'LAT', y: 'LON', date: 'DATE', CO2: 'FCO2_AVE_WEIGHTED', SSS: 'SALINITY_AVE_WEIGHTED', SST: 'SST_AVE_WEIGHTED' }, filter: { SSS: { min: 26, max: 40 }, CO2: { min: 200, max: 500 }, date: { min: 1993, max: 2018 }, x: { min: 30, max: 80 }, y: { min: -75, max: 26 } }, date: dd_mm_yyyy, errors: 500 }\r\n    ].forEach(s => this.load_data(s)\r\n      .then(d => {\r\n        this.data[d.name] = d\r\n        if (d.errors.length) console.log(d.name, 'errors', d.errors)\r\n        console.log(d.name, { lines: d.lines, filtered: d.filter, d })\r\n        if (d.name === 'SOCAT') this.setState({ socat: d })\r\n        else this.setState({ cpr: d })\r\n      }).catch(e => {\r\n        console.error(e.name, 'too many errors', e.errors)\r\n      }))\r\n  }\r\n  componentWillUnmount() {\r\n    this.animate('stop')\r\n  }\r\n  load_data(f) {\r\n    return new Promise((resolve, reject) => {\r\n      fetch(f.data)\r\n        .then(function (response) {\r\n          return response.arrayBuffer()\r\n        })\r\n        .then(csv => {\r\n          let rows = pako.inflate(csv, { to: 'string' }).split(/\\r\\n|\\n/).map(l => { return l.replace(/\"([^,]*), ([^,]*)\"/, \"$2 $1\").replace(/\"/g, '').split(',') })\r\n          const head = rows[0].map(r => { return r.trim() })\r\n          const data = { name: f.name, l: {}, ps: {}, ys: {}, n: [], errors: [], lines: 0, filter: 0 }\r\n          for (data.lines = 1; data.lines < rows.length && data.errors.length < f.errors; data.lines++) {\r\n            const r = rows[data.lines]\r\n            const d = {}, ks = Object.keys(f.cols)\r\n            for (var i = 0; i < ks.length; i++) {\r\n              const k = ks[i]\r\n              if (!r[head.indexOf(f.cols[k])]) {\r\n                d.error = true\r\n                if (!d.error) data.errors.push({ e: '1', file: f.name, line: data.lines, k: k })\r\n              }\r\n              else {\r\n                if (k === 'date') d[k] = f.date(r[head.indexOf(f.cols[k])])\r\n                else d[k] = r[head.indexOf(f.cols[k])] * 1\r\n              }\r\n              if (!d[k] && d[k] !== 0 && !d.error) {\r\n                d.error = true\r\n                data.errors.push({ e: '2', file: f.name, line: data.lines, k: k })\r\n              }\r\n            }\r\n            if (!d.error && ((!d.x && d.x !== 0) || (!d.y && d.y !== 0) || !d.date)) {\r\n              d.error = true\r\n              data.errors.push({ e: '3', file: f.name, line: data.lines, x: d.x, y: d.y })\r\n            }\r\n            if (!d.error && f.filter) Object.keys(f.filter).forEach(x => {\r\n              let l = { line: data.lines }\r\n              if (x === 'date') {\r\n                if (!d.filter && (d.date.getFullYear() < f.filter.date.min || d.date.getFullYear() > f.filter.date.max)) {\r\n                  d.filter = true\r\n                  l[x] = d[x].toString()\r\n                  data.filter++ //.push(l)\r\n                }\r\n              }\r\n              else {\r\n                if (!d.filter && (d[x] < f.filter[x].min || d[x] > f.filter[x].max)) {\r\n                  d.filter = true\r\n                  l[x] = d[x]\r\n                  data.filter++ //.push(l)\r\n                }\r\n              }\r\n            })\r\n            if (!d.error && !d.filter) {\r\n              const year = d.date.getFullYear()\r\n              const month = d.date.getMonth()\r\n              const p = Math.round(d.x * 10000) + d.y\r\n              if (!data.ps[year]) data.ps[year] = {}\r\n              if (!data.ps[year][month]) data.ps[year][month] = {}\r\n              if (!data.ps[year][month][p]) {\r\n                data.ps[year][month][p] = d\r\n                  ;['x', 'y', 'CO2', 'SSS', 'SST', 'ABUN'].forEach(k => {\r\n                    if (data.l[k] === undefined) data.l[k] = { min: d[k], max: d[k] }\r\n                    else if (d[k] === -1e34) { /*skip*/ }\r\n                    else if (d[k] < data.l[k].min) data.l[k].min = d[k]\r\n                    else if (d[k] > data.l[k].max) data.l[k].max = d[k]\r\n                  })\r\n\r\n              }\r\n              else data.errors.push({ e: 'dupe', file: f.name, line: data.lines, x: d.x, y: d.y })\r\n            }\r\n          }\r\n          if (data.errors.length < f.errors) {\r\n            /* Object.keys(data.ps).forEach(p => {\r\n               const n = Object.keys(data.ps[p]).length\r\n               Object.keys(data.ps[p]).forEach(y => {\r\n                 if (!data.ys[y]) data.ys[y] = []\r\n                 if (!data.ys[y][n]) data.ys[y][n] = []\r\n                 data.ys[y][n].push(p)\r\n               })\r\n               if (!data.n[n]) data.n[n] = []\r\n               data.n[n].push(p)\r\n             })\r\n             data.t = this.totals(data)\r\n             */\r\n            resolve(data)\r\n          }\r\n          else reject(data)\r\n        })\r\n    })\r\n  }\r\n  totals(data) {\r\n    const ret = {}\r\n    Object.keys(data.ys).forEach(y => {\r\n      Object.keys(data.ys[y]).forEach(c => {\r\n        let t = 0, n = 0\r\n        data.ys[y][c].forEach(p => {\r\n          data.ps[p][y].forEach(d => {\r\n            n += 1 / data.ps[p][y].length\r\n            t += d.n / data.ps[p][y].length\r\n          })\r\n        })\r\n        if (!ret[y]) ret[y] = {}\r\n        if (!ret[y][c]) ret[y][c] = {}\r\n        ret[y][c] = { n: n, t: t }\r\n      })\r\n    })\r\n    //console.log('totals',ret)\r\n    return ret\r\n  }\r\n  monthTimer = (set) => {\r\n    const m = this.state.m\r\n    if (this.timer) clearTimeout(this.timer)\r\n    if (set) this.setState({ a: set, m: 0, y: 'all', y2: null, m2: null })\r\n    else if (m === 11) this.setState({ m: 0 })\r\n    else this.setState({ m: m + 1 })\r\n    this.timer = setTimeout(this.monthTimer, m === 11 ? 3000 : 1000)\r\n  }\r\n  yearTimer = (set) => {\r\n    const y = this.state.y\r\n    const socat = this.state.socat, ys = Object.keys(socat.ps)\r\n    if (this.timer) clearTimeout(this.timer)\r\n    if (set) this.setState({ a: set, y: ys[0], m: 'all', y2: null, m2: null })\r\n    else if (y === ys[ys.length - 1]) this.setState({ y: ys[0] })\r\n    else this.setState({ y: ys[ys.indexOf(y) + 1] })\r\n    this.timer = setTimeout(this.yearTimer, y === ys[ys.length - 1] ? 3000 : 1000)\r\n  }\r\n  animate = (arg) => {\r\n    const a = ['Animate', 'by month', 'by year'].indexOf(arg)\r\n    if (this.timer) clearTimeout(this.timer)\r\n    this.timer = null\r\n    if (a === 0 || a === -1) this.setState({ a: null, y: null, m: null })\r\n    else if (a === 1) this.monthTimer(arg)\r\n    else if (a === 2) this.yearTimer(arg)\r\n  }\r\n  render() {\r\n    const socat = this.state.socat\r\n    if (!socat) return <div>loading data ...</div>\r\n    const y = this.state.y, y2 = this.state.y2, ys = Object.keys(socat.ps)\r\n    const m = this.state.m, m2 = this.state.m2\r\n    const c = this.state.c, s = this.state.s, a = this.state.a\r\n    const cpr = this.state.cpr\r\n    return <div>\r\n      <div>\r\n        <Select ks={['ABUN']} k={this.state.c} set={f => this.setState({ c: f })} name=\"CPR\" />\r\n        <Select ks={['CO2', 'SSS', 'SST']} k={this.state.s} set={f => this.setState({ s: f })} name=\"SOCAT\" />\r\n        {c || s ? a === 'by year' || a === 'by month' ? <button onClick={() => this.animate('stop')}>Stop</button> :\r\n          <React.Fragment>\r\n            <span> </span>\r\n            <Select ks={['by year', 'by month']} k={a} set={this.animate} name=\"Animate\" />\r\n            <span> or </span>\r\n            <Select ks={ys} all k={y} set={y => this.setState({ y: y, y2: null, })} name=\"Year\" />\r\n            {y && y !== 'all' && y !== '2018' ? <Select ks={ys} s={y} k={y2} set={y => this.setState({ y2: y })} name=\"...Year\" /> : null}\r\n            <Select ks={mnth} all k={m === 'all' ? 'all' : mnth[m]} set={m => this.setState({ m: m === 'all' ? 'all' : m && mnth.indexOf(m), m2: null })} name=\"Month\" />\r\n            {(m || m === 0) && m !== 'all' && m !== 11 ? <Select ks={mnth} s={mnth[m]} k={mnth[m2]} set={m => this.setState({ m2: m && mnth.indexOf(m) })} name=\"...Month\" /> : null}\r\n          </React.Fragment> : null\r\n        }\r\n        <span> {y === 'all' ? '1993-2018' : y}{y2 ? '-' + y2 : null} {m === 12 || m === 'all' ? 'Jan-Dec' : mnth[m]}{m2 ? '-' + mnth[m2] : null}</span>\r\n      </div>\r\n      {socat && <Map bounds={[[socat.l.x.min, socat.l.y.min], [socat.l.x.max, socat.l.y.max]]}>\r\n        <TileLayer\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n        />\r\n        {s ? <PYM data={socat} m={m} y={y} y2={y2} m2={m2} f={s} a={this.state.a} /> : null}\r\n        {c ? <PYM data={cpr} m={m} y={y} y2={y2} m2={m2} f={c} a={this.state.a} /> : null}\r\n      </Map>}\r\n    </div>\r\n  }\r\n  //      {data && <Totals data={data} />}\r\n}\r\n\r\nclass PYM extends Component {\r\n  render() {\r\n    const y = this.props.y, m = this.props.m, y2 = this.props.y2, m2 = this.props.m2, f = this.props.f, d = this.props.data,\r\n      ys = Object.keys(d.ps), a = this.props.a\r\n    //console.log('PYM', { y, y2, m, m2, f, d, l: d.l })\r\n    let ret = [], n = 0, dedupe = 0, zero = 0, pa = []\r\n    ys.forEach(yr => {\r\n      if (y === 'all' || yr === y || (y2 && yr <= y2 && yr > y)) {\r\n        mnth.forEach(mn => {\r\n          const mi = mnth.indexOf(mn)\r\n          if (m === 'all' || m === 12 || mi === m || (m2 && mi > m && mi <= m2)) {\r\n            const ps = points({ y: yr, m: mi, f, d })\r\n            if (ps.length) {\r\n              pa.push(ps)\r\n              n += ps.length\r\n            }\r\n            if (!a) console.log(yr, mn, ps.length)\r\n          }\r\n        })\r\n      }\r\n    })\r\n    if (pa.length) {\r\n      let i = 0, cs = {}\r\n      pa.forEach(ps => {\r\n        ps.forEach(p => {\r\n          if (!cs[p.center[0] * 1000 + p.center[1]]) {\r\n            if (n < 7000 || p.color) ret.push(<CircleMarker key={i++} center={p.center} radius={p.radius} color={p.color} />)\r\n            cs[p.center[0] * 1000 + p.center[1]] = true\r\n          }\r\n          else dedupe++\r\n          if (!p.color) zero++\r\n        })\r\n      })\r\n    }\r\n    console.log('PYM', { y, m, f, n, zero, dedupe })\r\n    return ret.length ? ret : null\r\n  }\r\n}\r\n\r\nfunction points(p) {\r\n  let ret = []\r\n  const y = p.y, m = p.m, f = p.f, d = p.d,\r\n    ps = y && (m || m === 0) && d.ps[y] && d.ps[y][m] && Object.keys(d.ps[y][m])\r\n  //console.log('Points', { y, m, f, d, l: d.l })\r\n  if (ps) ps.forEach(p => {\r\n    const v = d.ps[y][m][p]\r\n    const l = d.l, c = (v[f] - l[f].min) / (l[f].max - l[f].min)\r\n    const color = v[f] && (f === 'ABUN' ? v[f] && '#00' + (255 - Math.round(c * 255)).toString(16) + '00'\r\n      : '#' + (255 - Math.round(c * 255)).toString(16) + '0000')\r\n    //if (color.length !== 7) console.log(color) - 0 if v[f]===0 so just dot\r\n    if (v[f] !== -1e34) {\r\n      ret.push({ center: [v.x, v.y], radius: 1, color: color })\r\n    }\r\n  })\r\n  return ret\r\n}\r\n\r\n/*\r\nclass Totals extends Component {\r\n  render() {\r\n    const d = this.props.data, totals = this.props.data['t']\r\n    return <table>\r\n      <thead><tr><th>Years</th>\r\n        {Object.keys(d.n).reverse().map(n => {\r\n          return <th colSpan={4} key={n}>{n}</th>\r\n        })}\r\n      </tr>\r\n        <tr><th>Year</th>\r\n          {Object.keys(d.n).reverse().map(n => {\r\n            return <React.Fragment key={n}><th>n</th><th>total</th><th>μ</th><th>μ+</th></React.Fragment>\r\n          })}\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {Object.keys(totals).map(y => {\r\n          let t = 0, n = 0\r\n          return <tr key={y}><td>{y}</td>\r\n            {Object.keys(d.n).reverse().map(c => {\r\n              if (!totals[y][c]) return <React.Fragment key={c}><td></td><td></td><td></td><td></td></React.Fragment>\r\n              const dt = totals[y][c].t, dn = totals[y][c].n\r\n              t += dt\r\n              n += dn\r\n              return <React.Fragment key={c}><td>{Math.round(dn)}</td><td>{Math.round(dt)}</td><td>{Math.round(dt / dn)}</td><td>{Math.round(t / n)}</td></React.Fragment>\r\n            })}</tr>\r\n        })}\r\n      </tbody>\r\n    </table>\r\n  }\r\n}\r\n*/\r\n\r\nclass Select extends Component {\r\n  set = (e) => {\r\n    e.preventDefault()\r\n    this.props.set(e.target.value)\r\n  }\r\n  render() {\r\n    let options = [<option key={''} value=''>{this.props.name}</option>]\r\n    const s = this.props.s\r\n    let ss = false\r\n    if (this.props.all) options.push(<option key={'all'} value='all'>All</option>)\r\n    this.props.ks.forEach(e => {\r\n      if (!s || ss) options.push(<option key={e}>{e}</option>)\r\n      else if (s === e) ss = true\r\n    })\r\n    return <span>\r\n      <select value={this.props.k || ''} onChange={this.set}>{options}</select>\r\n    </span>\r\n  }\r\n}\r\n\r\nexport { Emma }","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {Emma} from './Emma';\r\nimport './index.css'\r\n\r\nReactDOM.render(\r\n  <Emma />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}